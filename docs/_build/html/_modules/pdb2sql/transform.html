
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>pdb2sql.transform &#8212; pdb2sql 0.2.2 documentation</title>
    <link rel="stylesheet" href="../../_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">pdb2sql 0.2.2 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for pdb2sql.transform</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">time</span> <span class="k">import</span> <span class="n">time</span>
<span class="kn">from</span> <span class="nn">.pdb2sqlcore</span> <span class="k">import</span> <span class="n">pdb2sql</span>

<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">This file contains several transformations of the</span>
<span class="sd">molecular coordinate that might be usefull during the</span>
<span class="sd">definition of the data set.</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="c1">########################################################################</span>
<span class="c1"># Translation</span>
<span class="c1">########################################################################</span>
<div class="viewcode-block" id="translation"><a class="viewcode-back" href="../../api/pdb2sql.transform.translation.html#pdb2sql.transform.translation">[docs]</a><span class="k">def</span> <span class="nf">translation</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="n">vect</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">xyz</span> <span class="o">=</span> <span class="n">_get_xyz</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">xyz</span> <span class="o">+=</span> <span class="n">vect</span>
    <span class="n">_update</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="n">xyz</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<span class="c1">########################################################################</span>
<span class="c1"># Rotation using axisâ€“angle presentation</span>
<span class="c1"># see https://en.wikipedia.org/wiki/Rotation_matrix#Rotation_matrix_from_axis_and_angle</span>
<span class="c1">########################################################################</span>
<div class="viewcode-block" id="rot_axis"><a class="viewcode-back" href="../../api/pdb2sql.transform.rot_axis.html#pdb2sql.transform.rot_axis">[docs]</a><span class="k">def</span> <span class="nf">rot_axis</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">angle</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">xyz</span> <span class="o">=</span> <span class="n">_get_xyz</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">xyz</span> <span class="o">=</span> <span class="n">rot_xyz_around_axis</span><span class="p">(</span><span class="n">xyz</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">angle</span><span class="p">)</span>
    <span class="n">_update</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="n">xyz</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="get_rot_axis_angle"><a class="viewcode-back" href="../../api/pdb2sql.transform.get_rot_axis_angle.html#pdb2sql.transform.get_rot_axis_angle">[docs]</a><span class="k">def</span> <span class="nf">get_rot_axis_angle</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get the rotation angle and axis.</span>

<span class="sd">    Args:</span>
<span class="sd">        seed(int): random seed for numpy</span>

<span class="sd">    Returns:</span>
<span class="sd">        list(float): axis of rotation</span>
<span class="sd">        float: angle of rotation</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">seed</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="n">seed</span><span class="p">)</span>

    <span class="c1"># define the rotation axis</span>
    <span class="c1"># uniform distribution on a sphere</span>
    <span class="c1"># eq1,2 in http://mathworld.wolfram.com/SpherePointPicking.html</span>
    <span class="n">u1</span><span class="p">,</span> <span class="n">u2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(),</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span>
    <span class="n">theta</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">u1</span>      <span class="c1"># [0, 2*pi)</span>
    <span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">u2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="c1"># [0, pi]</span>
    <span class="c1"># eq19 in http://mathworld.wolfram.com/SphericalCoordinates.html</span>
    <span class="n">axis</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span>
            <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span>
            <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)]</span>

    <span class="c1"># define the rotation angle</span>
    <span class="n">angle</span> <span class="o">=</span>  <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">()</span>

    <span class="k">return</span> <span class="n">axis</span><span class="p">,</span> <span class="n">angle</span></div>

<div class="viewcode-block" id="rot_xyz_around_axis"><a class="viewcode-back" href="../../api/pdb2sql.transform.rot_xyz_around_axis.html#pdb2sql.transform.rot_xyz_around_axis">[docs]</a><span class="k">def</span> <span class="nf">rot_xyz_around_axis</span><span class="p">(</span><span class="n">xyz</span><span class="p">,</span> <span class="n">axis</span><span class="p">,</span> <span class="n">angle</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Get the rotated xyz.</span>

<span class="sd">    Args:</span>
<span class="sd">        xyz(np.array): original xyz coordinates</span>
<span class="sd">        axis (list(float)): axis of rotation</span>
<span class="sd">        angle (float): angle of rotation</span>
<span class="sd">        center (list(float)): center of rotation,</span>
<span class="sd">            defaults to the mean of input xyz.</span>

<span class="sd">    Returns:</span>
<span class="sd">        np.array: rotated xyz coordinates</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># get the data</span>
    <span class="n">ct</span><span class="p">,</span> <span class="n">st</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">)</span>
    <span class="n">ux</span><span class="p">,</span> <span class="n">uy</span><span class="p">,</span> <span class="n">uz</span> <span class="o">=</span> <span class="n">axis</span>

    <span class="c1"># definition of the rotation matrix</span>
    <span class="n">rot_mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">ct</span> <span class="o">+</span> <span class="n">ux</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">ct</span><span class="p">),</span>
                         <span class="n">ux</span> <span class="o">*</span> <span class="n">uy</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">ct</span><span class="p">)</span> <span class="o">-</span> <span class="n">uz</span> <span class="o">*</span> <span class="n">st</span><span class="p">,</span>
                         <span class="n">ux</span> <span class="o">*</span> <span class="n">uz</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">ct</span><span class="p">)</span> <span class="o">+</span> <span class="n">uy</span> <span class="o">*</span> <span class="n">st</span><span class="p">],</span>
                        <span class="p">[</span><span class="n">uy</span> <span class="o">*</span> <span class="n">ux</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">ct</span><span class="p">)</span> <span class="o">+</span> <span class="n">uz</span> <span class="o">*</span> <span class="n">st</span><span class="p">,</span>
                         <span class="n">ct</span> <span class="o">+</span> <span class="n">uy</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">ct</span><span class="p">),</span>
                         <span class="n">uy</span> <span class="o">*</span> <span class="n">uz</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">ct</span><span class="p">)</span> <span class="o">-</span> <span class="n">ux</span> <span class="o">*</span> <span class="n">st</span><span class="p">],</span>
                        <span class="p">[</span><span class="n">uz</span> <span class="o">*</span> <span class="n">ux</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">ct</span><span class="p">)</span> <span class="o">-</span> <span class="n">uy</span> <span class="o">*</span> <span class="n">st</span><span class="p">,</span>
                         <span class="n">uz</span> <span class="o">*</span> <span class="n">uy</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">ct</span><span class="p">)</span> <span class="o">+</span> <span class="n">ux</span> <span class="o">*</span> <span class="n">st</span><span class="p">,</span>
                         <span class="n">ct</span> <span class="o">+</span> <span class="n">uz</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">ct</span><span class="p">)]])</span>

    <span class="c1"># apply the rotation</span>
    <span class="k">return</span> <span class="n">rotate</span><span class="p">(</span><span class="n">xyz</span><span class="p">,</span> <span class="n">rot_mat</span><span class="p">,</span> <span class="n">center</span><span class="p">)</span></div>

<span class="c1">########################################################################</span>
<span class="c1"># Rotation using Euler anlges</span>
<span class="c1"># see https://en.wikipedia.org/wiki/Rotation_matrix#General_rotations</span>
<span class="c1">########################################################################</span>

<div class="viewcode-block" id="rot_euler"><a class="viewcode-back" href="../../api/pdb2sql.transform.rot_euler.html#pdb2sql.transform.rot_euler">[docs]</a><span class="k">def</span> <span class="nf">rot_euler</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Rotate molecule from Euler rotation axis.</span>

<span class="sd">    Args:</span>
<span class="sd">        alpha (float): angle of rotation around the x axis</span>
<span class="sd">        beta (float): angle of rotation around the y axis</span>
<span class="sd">        gamma (float): angle of rotation around the z axis</span>
<span class="sd">        **kwargs: keyword argument to select the atoms.</span>
<span class="sd">            See pdb2sql.get()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">xyz</span> <span class="o">=</span> <span class="n">_get_xyz</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">xyz</span> <span class="o">=</span> <span class="n">rotation_euler</span><span class="p">(</span><span class="n">xyz</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">gamma</span><span class="p">)</span>
    <span class="n">_update</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="n">xyz</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="rotation_euler"><a class="viewcode-back" href="../../api/pdb2sql.transform.rotation_euler.html#pdb2sql.transform.rotation_euler">[docs]</a><span class="k">def</span> <span class="nf">rotation_euler</span><span class="p">(</span><span class="n">xyz</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

    <span class="c1"># precomte the trig</span>
    <span class="n">ca</span><span class="p">,</span> <span class="n">sa</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">alpha</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>
    <span class="n">cb</span><span class="p">,</span> <span class="n">sb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">beta</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">beta</span><span class="p">)</span>
    <span class="n">cg</span><span class="p">,</span> <span class="n">sg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">gamma</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">gamma</span><span class="p">)</span>

    <span class="c1"># rotation matrices</span>
    <span class="n">rx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">ca</span><span class="p">,</span> <span class="o">-</span><span class="n">sa</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">sa</span><span class="p">,</span> <span class="n">ca</span><span class="p">]])</span>
    <span class="n">ry</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">cb</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">sb</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="n">sb</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">cb</span><span class="p">]])</span>
    <span class="n">rz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">cg</span><span class="p">,</span> <span class="o">-</span><span class="n">sg</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="n">sg</span><span class="p">,</span> <span class="n">cg</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>

    <span class="c1"># get rotation matrix</span>
    <span class="n">rot_mat</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">rz</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">ry</span><span class="p">,</span> <span class="n">rx</span><span class="p">))</span>

    <span class="c1"># apply the rotation</span>
    <span class="k">return</span> <span class="n">rotate</span><span class="p">(</span><span class="n">xyz</span><span class="p">,</span> <span class="n">rot_mat</span><span class="p">,</span> <span class="n">center</span><span class="p">)</span></div>

<span class="c1">########################################################################</span>
<span class="c1"># Rotation using provided rotation matrix</span>
<span class="c1">########################################################################</span>

<div class="viewcode-block" id="rot_mat"><a class="viewcode-back" href="../../api/pdb2sql.transform.rot_mat.html#pdb2sql.transform.rot_mat">[docs]</a><span class="k">def</span> <span class="nf">rot_mat</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="n">mat</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Rotate molecule from a rotation matrix.</span>

<span class="sd">    Args:</span>
<span class="sd">        mat (np.array): 3x3 rotation matrix</span>
<span class="sd">        **kwargs: keyword argument to select the atoms.</span>
<span class="sd">            See pdb2sql.get()</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">xyz</span> <span class="o">=</span> <span class="n">_get_xyz</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="n">xyz</span> <span class="o">=</span> <span class="n">rotate</span><span class="p">(</span><span class="n">xyz</span><span class="p">,</span> <span class="n">mat</span><span class="p">)</span>
    <span class="n">_update</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="n">xyz</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="rotate"><a class="viewcode-back" href="../../api/pdb2sql.transform.rotate.html#pdb2sql.transform.rotate">[docs]</a><span class="k">def</span> <span class="nf">rotate</span><span class="p">(</span><span class="n">xyz</span><span class="p">,</span> <span class="n">rot_mat</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Rotate xyz from a rotation matrix.</span>

<span class="sd">    Args:</span>
<span class="sd">        xyz(np.ndarray): x,y,z coordinates</span>
<span class="sd">        rot_mat(np.ndarray): rotation matrix</span>
<span class="sd">        center (list or np.ndarray, optional): rotation center.</span>
<span class="sd">            Defaults to None, i.e. using molecule center as rotation</span>
<span class="sd">            center.</span>

<span class="sd">    Raises:</span>
<span class="sd">        TypeError: Rotation center must be list or 1D np.ndarray.</span>

<span class="sd">    Returns:</span>
<span class="sd">        np.ndarray: x,y,z coordinates after rotation</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># the default rotation center is the center of molecule itself.</span>
    <span class="k">if</span> <span class="n">center</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">center</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">xyz</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">center</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Rotation center must be list or 1D np.ndarray&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">rot_mat</span><span class="p">,</span> <span class="p">(</span><span class="n">xyz</span> <span class="o">-</span> <span class="n">center</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">T</span> <span class="o">+</span> <span class="n">center</span></div>

<span class="c1">########################################################################</span>
<span class="c1"># helper functions</span>
<span class="c1">########################################################################</span>
<span class="k">def</span> <span class="nf">_get_xyz</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">db</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;x,y,z&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">_update</span><span class="p">(</span><span class="n">db</span><span class="p">,</span> <span class="n">xyz</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
    <span class="n">db</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="s1">&#39;x,y,z&#39;</span><span class="p">,</span> <span class="n">xyz</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">pdb2sql 0.2.2 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2019, Netherlands eScience Center.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.1.2.
    </div>
  </body>
</html>